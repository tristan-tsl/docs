---

---

# 背景介绍

项目名称: 自动化运维平台

​		为了提高运维效率、减少重复性的工作量从而达到提高总体的运维的水平、为公司节约人员、为上层业务提供更加快捷稳定的底层应用

目前已经实现的功能:

公司的钉钉的扫码登录

用户管理/组织架构管理/权限管理/用户标签管理

资产管理:

​	服务器管理

​	数据管理:

​		mysql
​		oracle

​	容器编排工具管理

​	构建服务器管理

​	源码管理:

​		svn

流程

​	审核

​	驳回

​	回滚

​	延迟执行

工单

​	执行SQL

​	代码发布

​	修改计划任务



下一个版本:(已开发、未测试)

​		自发性、开放性的监控告警

# 功能介绍

基础地址: [http://pass.yibainetwork.com](http://pass.yibainetwork.com/)

## 首页

## 登录/注销

![1568714723346](D:\docs\tristan\Pass平台\交付文档\pic\1568714723346.png)



点击工作台可以查看当前登录用户的名称

如果没有登录会自动展示钉钉扫码登录的弹出框

如果已经登录可以通过点击注销登录按钮进行注销登录并展示扫码登录的弹出框

打开->手机APP-钉钉 -> 点击底部消息 -> 点击'+' -> 点击'扫一扫' -> 点击 '登录网页版运维平台'

## 工单流程审核

![1568768890018](D:\docs\tristan\Pass平台\交付文档\pic\1568768890018.png)



搜索框部分:

|   名称   |                             意义                             |
| :------: | :----------------------------------------------------------: |
|    ID    | 流程的唯一标识,可用于创建流程时的前置工单,系统生成,搜索时必须全词匹配 |
|   标题   |      该工单含有的业务含义，创建工单时手动输入,模糊匹配       |
| 业务类型 |              取值为 执行SQL、项目部署、调度管理              |
|   状态   |       取值为 已完结、运行中、已驳回、已销毁、延迟执行        |
| 审核记录 |     取值为时间范围,用于查找执行时间段创建的流程,点击选择     |
| 剩余流程 | 取值为 以自己为中心、全局, 以自己为中心意味着剩余流程必须包含自己,默认为全局 |
| 总体流程 | 取值为 以自己为中心、全局, 以自己为中心意味着整体流程必须包含自己,默认为全局 |

搜索按钮: 根据搜索条件,进行交集查询

重置按钮:重置搜索条件

流程操作部分:

|      名称      |                             含义                             |
| :------------: | :----------------------------------------------------------: |
|    审核通过    | 流程进度下一个阶段,如果流程已经为最后一个阶段,则会完结流程,调用到具体业务,产生日志 |
|    审核驳回    |                   将流程销毁并设置驳回理由                   |
|      内容      |                      流程中的业务的内容                      |
|      日志      |   异步通过流程ID记录出来的流程的业务在执行过程中产生的日志   |
|      销毁      |                           直接销毁                           |
| 指定执行时间段 |  延迟流程到具体时间段内执行,该界面有一键设置功能,从x点-x点   |

分页操作部分:

页码和每页展示条数

## 工单

### 公共说明

|   名称   |                             含义                             | 取值                                                         |
| :------: | :----------------------------------------------------------: | ------------------------------------------------------------ |
| 前置工单 | 上游工单,用于当前创建的工单在最后一步审核流程中检测上游工单执行状态,只有上游工单执行完成才能执行当前工单 | 已经创建的流程的流程ID,在审核列表中查找                      |
|   标题   |    用户说明工单的业务含义和一些特征，创建工单人员自由发挥    |                                                              |
| 审核流程 | 当前登录人在当前业务中的审核流程,如果其中一个角色的所有人都没有完全匹配当前人的标签,则意味着当前登录人无法创建流程 | 在流程模板中由角色组成的流程,角色必须和当前登录的标签完全匹配，例如java、erp |
|   环境   |                 后续在整合线上和线下时会用到                 | dev                                                          |



### 发包

![1568770055369](D:\docs\tristan\Pass平台\交付文档\pic\1568770055369.png)



|   名称    |          含义          |      取值       |
| :-------: | :--------------------: | :-------------: |
| 项目类型  |       源码的类型       |    java、php    |
| 部署目标  | 默认即可，用于通用流程 |   服务器、k8s   |
|           |                        |                 |
| 携带的SQL |     用于给DBA审核      | 代码中的业务SQL |

部署java项目时

| 名称 |     含义      |              取值               |
| :--: | :-----------: | :-----------------------------: |
| 项目 | 项目名称,选择 | 项目部署在k8s中的deployment列表 |

部署php项目时

|  名称  |     含义      |            取值            |
| :----: | :-----------: | :------------------------: |
|  项目  | 项目名称,选择 | 项目部署在服务器的项目列表 |
| 包列表 | 取包的url列表 |    svn tag目录的url地址    |

当前审核流程为:

开发->测试->产品->产品组长

### 执行SQL

![1568771711016](C:\Users\tristan\AppData\Roaming\Typora\typora-user-images\1568771711016.png)

|   名称   |                             含义                             |                             取值                             |
| :------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|  MySQL   |                     需要操作的MySQL实例                      |                   资产管理中的MySQL的记录                    |
|  数据库  |                  MySQL实例中的数据库的名称                   | 实时查找上一栏MySQL实例中的数据库列表,同时会排除掉MySQL自身的数据库 |
| SQL内容  |                  需要执行SQL内容,以';'分隔                   |                                                              |
| 执行类型 | 如果该SQL工单是单纯的执行SQL,则选直接执行即可,如果为授权语句,则选应用服务器授权 |                   执行执行、应用服务器授权                   |

### 修改计划任务

![1568771719426](C:\Users\tristan\AppData\Roaming\Typora\typora-user-images\1568771719426.png)

|    名称     |         含义         |                             取值                             |
| :---------: | :------------------: | :----------------------------------------------------------: |
|   服务器    | 需要修改的调度服务器 |                    计划任务中配置的服务器                    |
| 行-内容列表 |     调度规则内容     | 实时展示改调度服务器的/etc/crontab文件内容,并将每一行变成一个展示对象进行展示 |